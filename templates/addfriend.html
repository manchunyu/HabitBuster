{% extends "layout.html" %}

{% block title %}Add a friend{% endblock %}

{% block main %}
    
    <input autofocus name="q" type="email" placeholder="Enter their Email">
    <button type="button">Search</button>
    
    <ul></ul>

    <script>
        let input = document.querySelector('input');
        let button = document.querySelector('button')

        button.addEventListener('click', async function() {

            let input = document.querySelector('input');
            let button = document.querySelector('button');

            button.addEventListener('click', async function() {
                try {
                    let response = await fetch('/search?q=' + encodeURIComponent(input.value));
                    
                    if (!response.ok) {
                        throw new Error('Friend not found');
                    }
    
                    let friend = await response.json();
    
                    let firstName = friend['first_name'];
                    let lastName = friend['last_name'];
                    let html = '';
                
                    html += '<li>' + firstName + ' ' + lastName + '</li>';
                
                    document.querySelector('ul').innerHTML = html;
            } catch (error) {
                document.querySelector('ul').innerHTML = '<li>' + error.message + '</li>';
            }
        })});
    </script>
{% endblock %}